<!DOCTYPE html>
<html>

<head>
  <style media="screen" type="text/css">
    body {
    padding: 20px;
    background-color:#ffffc9
    }

    p { margin : 0; }
  </style>

</head>

<body>

<p><button onclick="geoFindMe()">Show my weather</button></p>
<div id="out"></div>
<div id ="map"></div>


<script>
function geoFindMe() {
  var output = document.getElementById("out");
  var mapInDoc = document.getElementById("map");

  if (!navigator.geolocation) {
    output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
    return;
  }

  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;


    var url4API = "https://fcc-weather-api.glitch.me/api/current?" + 'lat=' + latitude + '&lon='+ longitude;

    var weatherCall = new XMLHttpRequest();
  

    weatherCall.open("GET", url4API, false);  

    weatherCall.send();

    var weatherResponse = JSON.parse(weatherCall.response);

    let tempInC = (weatherResponse.main.temp).toFixed(1);
    var tempInF = (((weatherResponse.main.temp) * (9/5)) + 32).toFixed(1);
    let deviceLocation = weatherResponse.name;  
    let weatherIcon = weatherResponse.weather[0].icon;

     output.innerHTML = '<p> The current temperature in ' + deviceLocation + ' is: ' + tempInC + '°C' + ' or ' + tempInF + '°F</p>';

    console.log(weatherResponse);

    var img = new Image(200, 200);
      img.src = weatherIcon;
    output.appendChild(img);

    
    var googleMap = new Image();
      googleMap.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";
    mapInDoc.appendChild(googleMap);



  }

  function error() {
    output.innerHTML = "Unable to retrieve your location";
  }

  output.innerHTML = "<p>Locating…</p>";

  navigator.geolocation.getCurrentPosition(success, error);
}
    



</script>

</body>
</html>

